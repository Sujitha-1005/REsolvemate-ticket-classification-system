<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ResolveMate - Login</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family:"Segoe UI",Tahoma,Geneva,Verdana,sans-serif;
      background:linear-gradient(to bottom,#E5D9F2,#CDC1FF);
      color:#222;
      display:flex;
      justify-content:center;
      align-items:center;
      min-height:100vh;
      padding:20px;
      position:relative;
      overflow-x:hidden;
    }
    
    /* Animated background elements */
    body:before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(0,75,107,0.05) 1px, transparent 1px);
      background-size: 50px 50px;
      animation: float 20s linear infinite;
      z-index: 0;
    }
    
    @keyframes float {
      0% { transform: translate(0, 0) rotate(0deg); }
      100% { transform: translate(-50px, -50px) rotate(360deg); }
    }
    
    .container{
      max-width:480px;
      width:100%;
      text-align:left;
      padding:50px 40px;
      background:rgba(255,255,255,.85);
      backdrop-filter:blur(15px);
      border-radius:20px;
      box-shadow:0 15px 35px rgba(0,0,0,.1);
      transition:all .4s ease;
      position:relative;
      z-index:1;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.3);
    }
    
    .container:before{
      content:'';
      position:absolute;
      top:-50%;
      left:-50%;
      width:200%;
      height:200%;
      background:linear-gradient(45deg,transparent,rgba(0,75,107,.03),transparent);
      transform:rotate(45deg);
      transition:all .8s ease;
      opacity:0;
    }
    
    .container:hover{
      transform:translateY(-8px);
      box-shadow:0 25px 50px rgba(0,75,107,.15);
    }
    
    .container:hover:before{
      opacity:1;
      transform:rotate(45deg) translate(30%,30%);
    }
    
    .logo{
      text-align:center;
      margin-bottom:35px;
      position:relative;
      z-index:2;
    }
    
    .logo h1{
      font-size:2.8rem;
      color:#004b6b;
      margin-bottom:8px;
      text-shadow:0 3px 6px rgba(0,75,107,.15);
      transition:all .3s ease;
      position:relative;
    }
    
    .logo h1:hover{
      transform:scale(1.05);
      color:#006c94;
    }
    
    .logo-subtitle{
      color:#666;
      font-size:1rem;
      font-weight:500;
      opacity:0.8;
    }
    
    h2{
      font-size:1.6rem;
      margin-bottom:35px;
      font-weight:600;
      color:#333;
      text-align:center;
      position:relative;
      z-index:2;
      transition:all .3s ease;
    }
    
    h2:hover{
      color:#004b6b;
      transform:translateY(-2px);
    }
    
    .form-group{
      margin-bottom:25px;
      position:relative;
      z-index:2;
    }
    
    label{
      display:block;
      margin-bottom:10px;
      font-weight:600;
      color:#004b6b;
      font-size:1.05rem;
      transition:all .3s ease;
    }
    
    .input-container{
      position:relative;
      overflow:hidden;
    }
    
    input[type="email"],input[type="password"],input[type="text"]{
      width:100%;
      padding:16px 20px;
      border:2px solid #ddd;
      border-radius:10px;
      font-size:1rem;
      transition:all .3s ease;
      background:rgba(255,255,255,.9);
      backdrop-filter:blur(5px);
    }
    
    .input-icon{
      position:absolute;
      left:18px;
      top:50%;
      transform:translateY(-50%);
      color:#999;
      font-size:1.1rem;
      transition:all .3s ease;
      z-index:1;
    }
    
    input[type="email"]:focus,input[type="password"]:focus,input[type="text"]:focus{
      border-color:#004b6b;
      outline:none;
      box-shadow:0 0 0 4px rgba(0,75,107,.12);
      transform:translateY(-3px);
      background:rgba(255,255,255,1);
    }
    
    .btn{
      display:block;
      width:100%;
      background:#004b6b;
      color:#fff;
      padding:18px;
      border:none;
      border-radius:10px;
      text-decoration:none;
      font-size:1.1rem;
      font-weight:bold;
      transition:all .3s ease;
      box-shadow:0 6px 15px rgba(0,75,107,.25);
      cursor:pointer;
      text-align:center;
      position:relative;
      overflow:hidden;
      z-index:2;
      text-transform:uppercase;
      letter-spacing:0.5px;
    }
    
    .btn:before{
      content:'';
      position:absolute;
      top:0;
      left:0;
      width:0%;
      height:100%;
      background:linear-gradient(45deg, #006c94, #0088cc);
      transition:width .4s ease;
      z-index:-1;
      border-radius:10px;
    }
    
    .btn:hover{
      transform:translateY(-4px);
      box-shadow:0 12px 25px rgba(0,75,107,.3);
    }
    
    .btn:hover:before{
      width:100%;
    }
    
    .btn:active{
      transform:translateY(-1px);
      box-shadow:0 4px 10px rgba(0,75,107,.25);
    }
    
    .btn.loading {
      position: relative;
      color: transparent;
    }
    
    .btn.loading:after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 20px;
      height: 20px;
      margin: -10px 0 0 -10px;
      border: 2px solid transparent;
      border-top: 2px solid #fff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .toggle-option{
      text-align:center;
      margin-top:35px;
      color:#555;
      position:relative;
      z-index:2;
      font-size:1rem;
    }
    
    .toggle-option a{
      color:#006c94;
      text-decoration:none;
      font-weight:600;
      transition:all .3s ease;
      cursor:pointer;
      position:relative;
      padding:2px 0;
    }
    
    .toggle-option a:before{
      content:'';
      position:absolute;
      bottom:0;
      left:0;
      width:0%;
      height:2px;
      background:#006c94;
      transition:width .3s ease;
    }
    
    .toggle-option a:hover{
      color:#004b6b;
      transform:translateY(-1px);
    }
    
    .toggle-option a:hover:before{
      width:100%;
    }
    
    #signupForm{
      display:none;
    }
    
    .status{
      margin-top:15px;
      font-size:.95rem;
      color:#004b6b;
      text-align:center;
      font-weight:500;
      position:relative;
      z-index:2;
      padding:10px;
      border-radius:8px;
      transition:all .3s ease;
    }
    
    .status.error{
      color:#d32f2f;
      background:rgba(211,47,47,.1);
      border:1px solid rgba(211,47,47,.2);
    }
    
    .status.success{
      color:#2e7d32;
      background:rgba(46,125,50,.1);
      border:1px solid rgba(46,125,50,.2);
    }
    
    /* Form transition animation */
    .form-container {
      position: relative;
      min-height: auto;
    }
    
    .form-container form {
      opacity: 1;
      transform: translateX(0);
      transition: all 0.4s ease;
    }
    
    .form-container form.slide-out {
      opacity: 0;
      transform: translateX(-30px);
      pointer-events: none;
    }
    
    .form-container form.slide-in {
      opacity: 1;
      transform: translateX(0);
      pointer-events: auto;
    }

    /* Responsive design */
    @media (max-width: 768px) {
      .container {
        margin: 20px;
        padding: 40px 25px;
        max-width: 100%;
      }
      
      .logo h1 {
        font-size: 2.2rem;
      }
      
      h2 {
        font-size: 1.4rem;
      }
      
      input[type="email"],
      input[type="password"],
      input[type="text"] {
        padding: 14px 18px;
        font-size: 0.95rem;
      }
      
      .btn {
        padding: 16px;
        font-size: 1rem;
      }
    }
    
    @media (max-width: 480px) {
      body {
        padding: 10px;
      }
      
      .container {
        padding: 30px 20px;
      }
      
      .logo h1 {
        font-size: 2rem;
      }
    }
    
    /* Enhanced focus states for accessibility */
    input[type="email"]:focus-visible,
    input[type="password"]:focus-visible,
    input[type="text"]:focus-visible {
      outline: 2px solid #004b6b;
      outline-offset: 2px;
    }
    
    .btn:focus-visible {
      outline: 2px solid #004b6b;
      outline-offset: 2px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo">
      <h1>ResolveMate.</h1>
      <p class="logo-subtitle">Smart Ticket Classification</p>
    </div>

    <div class="form-container">
      <!-- Login Form -->
      <form id="loginForm">
        <h2>Welcome Back!</h2>
        <div class="form-group">
          <label for="loginEmail">Email Address</label>
          <input type="email" id="loginEmail" placeholder="Enter your email" required />
        </div>
        <div class="form-group">
          <label for="loginPassword">Password</label>
          <input type="password" id="loginPassword" placeholder="Enter your password" required />
        </div>
        <button type="submit" class="btn" id="loginBtn">
          <i class="fa fa-sign-in-alt"></i> Sign In
        </button>
        <div class="status" id="loginStatus"></div>
        <div class="toggle-option">
          <p>New to ResolveMate? <a id="showSignup">Create Account</a></p>
        </div>
      </form>

      <!-- Signup Form -->
      <form id="signupForm">
        <h2><i class="fa fa-user-plus"></i> Join ResolveMate</h2>
        <div class="form-group">
          <label for="signupName">Full Name</label>
          <input type="text" id="signupName" placeholder="Enter your full name" required />
        </div>
        <div class="form-group">
          <label for="signupEmail">Email Address</label>
          <input type="email" id="signupEmail" placeholder="Enter your email" required />
        </div>
        <div class="form-group">
          <label for="signupPassword">Password</label>
          <input type="password" id="signupPassword" placeholder="Create a password" required />
        </div>
        <div class="form-group">
          <label for="confirmPassword">Confirm Password</label>
          <input type="password" id="confirmPassword" placeholder="Confirm your password" required />
        </div>
        <button type="submit" class="btn" id="signupBtn">
          <i class="fa fa-user-plus"></i> Create Account
        </button>
        <div class="status" id="signupStatus"></div>
        <div class="toggle-option">
          <p>Already have an account? <a id="showLogin">Sign In</a></p>
        </div>
      </form>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    import { getFirestore, doc, setDoc, addDoc, collection, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC7XHh5sxVlTscd1zx0lfS9ZW0szYsP4dk",
      authDomain: "resolvemate-c4ecf.firebaseapp.com",
      projectId: "resolvemate-c4ecf",
      storageBucket: "resolvemate-c4ecf.appspot.com",
      messagingSenderId: "909784257137",
      appId: "1:909784257137:web:4eef0d71776fed0c3301d0",
      measurementId: "G-YJ0RP7Q936"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    document.addEventListener('DOMContentLoaded', () => {
      const loginForm = document.getElementById('loginForm');
      const signupForm = document.getElementById('signupForm');
      const showSignupLink = document.getElementById('showSignup');
      const showLoginLink = document.getElementById('showLogin');
      const loginStatus = document.getElementById('loginStatus');
      const signupStatus = document.getElementById('signupStatus');
      const loginBtn = document.getElementById('loginBtn');
      const signupBtn = document.getElementById('signupBtn');

      const setStatus = (el, msg, type='info') => {
        el.textContent = msg;
        el.className = `status ${type}`;
      }

      const toggleForms = (showLogin = true) => {
        if (showLogin) {
          signupForm.classList.add('slide-out');
          setTimeout(() => {
            signupForm.style.display = 'none';
            loginForm.style.display = 'block';
            loginForm.classList.remove('slide-out');
            loginForm.classList.add('slide-in');
          }, 200);
        } else {
          loginForm.classList.add('slide-out');
          setTimeout(() => {
            loginForm.style.display = 'none';
            signupForm.style.display = 'block';
            signupForm.classList.remove('slide-out');
            signupForm.classList.add('slide-in');
          }, 200);
        }
        setStatus(loginStatus, '');
        setStatus(signupStatus, '');
      }

      showSignupLink.addEventListener('click', e => {
        e.preventDefault();
        toggleForms(false);
      });

      showLoginLink.addEventListener('click', e => {
        e.preventDefault();
        toggleForms(true);
      });

      // Signup
      signupForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const name = document.getElementById('signupName').value.trim();
        const email = document.getElementById('signupEmail').value.trim();
        const password = document.getElementById('signupPassword').value;
        const confirmPassword = document.getElementById('confirmPassword').value;

        if (!name || !email || !password || !confirmPassword) {
          setStatus(signupStatus, 'Please fill in all fields', 'error');
          return;
        }
        if (password !== confirmPassword) {
          setStatus(signupStatus, 'Passwords do not match', 'error');
          return;
        }
        if (password.length < 6) {
          setStatus(signupStatus, 'Password must be at least 6 characters', 'error');
          return;
        }

        signupBtn.classList.add('loading');
        signupBtn.disabled = true;
        setStatus(signupStatus, 'Creating your account...');

        try {
          const userCredential = await createUserWithEmailAndPassword(auth, email, password);
          const user = userCredential.user;

          // Save user info
          await setDoc(doc(db, 'users', user.uid), {
            full_name: name,
            email,
            created_at: serverTimestamp()
          });

          setStatus(signupStatus, '✅ Account created successfully!', 'success');
          
          setTimeout(() => {
            toggleForms(true);
            document.getElementById('loginEmail').value = email;
            setStatus(loginStatus, 'You can now sign in with your new account', 'success');
          }, 1500);

        } catch (error) {
          let errorMsg = 'Registration failed';
          if (error.code === 'auth/email-already-in-use') {
            errorMsg = 'Email is already registered';
          } else if (error.code === 'auth/invalid-email') {
            errorMsg = 'Invalid email address';
          } else if (error.code === 'auth/weak-password') {
            errorMsg = 'Password is too weak';
          }
          setStatus(signupStatus, errorMsg, 'error');
        } finally {
          signupBtn.classList.remove('loading');
          signupBtn.disabled = false;
        }
      });

      // Login
      loginForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const email = document.getElementById('loginEmail').value.trim();
        const password = document.getElementById('loginPassword').value;

        if (!email || !password) {
          setStatus(loginStatus, 'Please fill in all fields', 'error');
          return;
        }

        loginBtn.classList.add('loading');
        loginBtn.disabled = true;
        setStatus(loginStatus, 'Signing you in...');

        try {
          const userCredential = await signInWithEmailAndPassword(auth, email, password);
          const user = userCredential.user;

          // Save login history
          await addDoc(collection(db, 'history'), {
            user_id: user.uid,
            action: 'login',
            details: { via: 'email_password' },
            timestamp: serverTimestamp()
          });

          setStatus(loginStatus, '✅ Welcome back! Redirecting...', 'success');
          
          setTimeout(() => {
            window.location.href = '/dashboard';
          }, 1000);

        } catch (error) {
          let errorMsg = 'Login failed';
          if (error.code === 'auth/user-not-found') {
            errorMsg = 'No account found with this email';
          } else if (error.code === 'auth/wrong-password') {
            errorMsg = 'Incorrect password';
          } else if (error.code === 'auth/invalid-email') {
            errorMsg = 'Invalid email address';
          } else if (error.code === 'auth/too-many-requests') {
            errorMsg = 'Too many failed attempts. Please try again later';
          }
          setStatus(loginStatus, errorMsg, 'error');
        } finally {
          loginBtn.classList.remove('loading');
          loginBtn.disabled = false;
        }
      });

      // Auto redirect if already logged in
      onAuthStateChanged(auth, (user) => {
        if (user) {
          window.location.href = '/dashboard';
        }
      });
    });
  </script>
</body>
</html>